
  <div class="panel panel-default" style="margin:10px;">
    <div class="panel-heading" style="backgroundcolor:gray;">
      <h3 class="panel-title">Place Order</h3>
    </div>
    <div class="panel-body">
      <% if @carts.present? %>
        <table id="table" class="table table-striped table table-bordered">
          
          <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Unit price</th>
            <th>Quantity</th>
            <th>Subtotal</th>
            <th>Remove</th>
          <tr>
          
          <% @carts.each do |c|%>
            <tr id="product-<%= c.product.id %>" >
              <td><%= c.product.name %></td>
              <td><%= c.product.description %></td>
              <td><%= c.product.price %></td>
              <td><%= number_field_tag 'quantity', 1, :in => 1...10,
              :id => "num_field-#{c.product.id}" ,:class => "number-field-width",
              :onchange => "change_subtotal(#{c.product.price},#{c.product.id})" %></td>
              
              <td><span id="subtotal-<%= c.product.id %>"><%= c.product.price %></span></td>
              <td><%=link_to "Remove" ,cart_path(c.id), :method => "delete" %></td>
            </tr>
          <% end%>
          
        </table>
      <% else %>
      
      <% end %>
      
      <div style="margin-top:15px;">
        <div id="total_item"><%= @carts.count%> items in the cart </div>
        <br />
        <div id="payble_amount"></div>
        
        <%= button_to "Place Order", { :action => "new"}, :confirm => "Are you sure?", :method => :get, :class => "btn btn-primary" %>
        <%= button_to "Cancle", users_url, :method => :get, :class => "btn btn-primary" %>
      </div>  
    </div>
  </div>


<script type="text/javascript">
 $(document).ready(function(){
        total_amount();
      });


function change_subtotal(price,id)
{

  var val= $("#num_field-"+id).val();
  $("#subtotal-"+id).text(val*price);
  total_amount(id);
}

function total_amount()
{
  var rows = $("#table td:nth-child(5)");
        amt=0;
        for(var i=0; i< rows.length;i++)
          {
            amt= amt + parseInt(rows[i].textContent);
          
          }
          $("#payble_amount").text("Total payable amount :" + amt);
        

}
 </script>

